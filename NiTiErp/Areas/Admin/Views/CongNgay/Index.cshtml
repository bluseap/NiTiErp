
@{
    ViewData["Title"] = "Index";
}
@section Styles{

    <link href="~/lib/jQuery-EasyUI/themes/bootstrap/easyui.css" rel="stylesheet" />
    <link href="~/lib/jQuery-EasyUI/themes/icon.css" rel="stylesheet" />
    <link href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker.css" rel="stylesheet" />
}
@section Scripts{
    
    <script src="~/lib/jQuery-EasyUI/jquery.easyui.min.js" asp-append-version="true"></script>
    <script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.js" asp-append-version="true"></script>
    <script src="~/lib/bootstrap-datepicker/dist/locales/bootstrap-datepicker.vi.min.js" charset="UTF-8" asp-append-version="true"></script>

    <script src="~/lib/jQuery-EasyUI/datagrid-groupview.js" asp-append-version="true"></script>
    <script src="~/lib/jQuery-EasyUI/jquery.edatagrid.js" asp-append-version="true"></script>
    <script src="~/lib/jQuery-EasyUI/datagrid-cellediting.js" asp-append-version="true"></script>
    <script src="~/lib/jQuery-EasyUI/datagrid-export.js" asp-append-version="true"></script>


    <script src="~/app/controllers/congngay/index.js" asp-append-version="true"></script>
    <script>
        var congngay = new congngayController();
        congngay.initialize();

        var congngay = new congngay.loadDataData();
        var data = congngay.datatablecongngay;

        $(function () {
            var dg = $('#dg').datagrid({

                singleSelect: true,
                //collapsible: true,
                //fitColumns: true,
                rownumbers: true,
                toolbar: '#tb',
                data: data,
                view: groupview,
                groupField: 'TenPhong',
                groupFormatter: function (value, rows) {
                    return value + ' - ' + rows.length + ' Nhân viên ';
                },
                onClickRow: onClickRow,

                //,
                //onBeginEdit: onBeginEdit

                //frozenColumns: [[
                //    { field: 'TenNhanVien', title: 'Item ID', width: 200 },
                //    { field: 'TenKhuVuc', title: 'Product ID', width: 200 },
                //]],
                //columns: [[
                //    { field: 'TenPhong', title: 'List Price', width: 200, align: 'right' },
                //    { field: 'Ngay01', title: 'Unit Cost', width: 200, align: 'right' },
                //    { field: 'Ngay02', title: 'Attribute', width: 200 },
                //    { field: 'Ngay03', title: 'Status', width: 200 }
                //]]

            });
        });

       


        function getCacheContainer(t) {
            var view = $(t).closest('div.datagrid-view');
            var c = view.children('div.datagrid-editor-cache');
            if (!c.length) {
                c = $('<div class="datagrid-editor-cache" style="position:absolute;display:none"></div>').appendTo(view);
            }
            return c;
        }
        function getCacheEditor(t, field) {
            var c = getCacheContainer(t);
            return c.children('div.datagrid-editor-cache-' + field);
        }
        function setCacheEditor(t, field, editor) {
            var c = getCacheContainer(t);
            c.children('div.datagrid-editor-cache-' + field).remove();
            var e = $('<div class="datagrid-editor-cache-' + field + '"></div>').appendTo(c);
            e.append(editor);
        }

        var editIndex = undefined;
        function endEditing() {
            if (editIndex == undefined) { return true }
            if ($('#dg').datagrid('validateRow', editIndex)) {
                //var ed = $('#dg').datagrid('getEditor', { index: editIndex, field: 'productid' });
                //var productname = $(ed.target).combobox('getText');
                //$('#dg').datagrid('getRows')[editIndex]['productname'] = productname;
                $('#dg').datagrid('endEdit', editIndex);
                editIndex = undefined;
                return true;
            }
            else {
                return false;
            }
        }
        function onClickRow(index) {
            if (editIndex != index) {
                if (endEditing()) {
                    $('#dg').datagrid('selectRow', index).datagrid('beginEdit', index);
                    editIndex = index;
                }
                else {
                    $('#dg').datagrid('selectRow', editIndex);
                }
            }
        }



    </script>
}


<div class="">
    <div class="page-title">
        <div class="title_left">
            <small>
                <a class="btn btn-link ">
                    Lương
                </a>
                >>
                <a class="btn btn-link btnNhapCongLuongNgay">
                    Bảng chấm công ngày nhân viên
                </a>
            </small>
        </div>
        @*<div class="title_right">
                <div class="col-md-3 col-sm-3 col-xs-12 form-group pull-right top_search">
                    <button class="btn btn-round btn-warning" id="btn-create" type="button">Tạo mới</button>
                </div>
                <div class="col-md-5 col-sm-5 col-xs-12 form-group pull-right top_search">
                    <div class="input-group">
                    </div>
                </div>
            </div>*@
    </div>

    <div class="clearfix"></div>

    <div class="x_content">
        <div class="">
            <div class="page-title">
                <div class="title_left">
                    <h3>  <small>Danh sách Bảng chấm công ngày nhân viên</small></h3>
                </div>
                <div class="title_right">
                    <div class="col-md-2 col-sm-2 col-xs-12 form-group pull-right">
                        <div class="input-group">
                            <select id="ddlThang" class="form-control"></select>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-2 col-xs-12 form-group pull-right top_search">
                        <div class="input-group">
                            <label for="lbThang" class="control-label  ">Tháng </label>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-2 col-xs-12 form-group pull-right">
                        <div class="input-group">
                            <input type="text" class="form-control" id="txtNam" placeholder="Năm khám sức khỏe">
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-2 col-xs-12 form-group pull-right top_search">
                        <div class="input-group">
                            <label for="lbNam" class="control-label  ">Năm </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="page-title">
                <div class="title_left">
                    <h3>  <small></small></h3>
                </div>
                <div class="title_right">
                    <div class="col-md-5 col-sm-2 col-xs-12 form-group pull-right">
                        <div class="input-group">
                            <input type="text" id="txtTimNhanVien" class="form-control" placeholder="Từ khóa...">
                            <span class="input-group-btn">
                                <button class="btn btn-primary" id="btnTimNhanVien" type="button">Tìm !</button>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-12 form-group pull-right top_search">
                        <div class="input-group">
                            <select id="ddlPhongBan" class="form-control"></select>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-2 col-xs-12 form-group pull-right top_search">
                        <div class="input-group">
                            <select id="ddlKhuVuc" class="form-control"></select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="row">
                <div class="col-md-2 col-sm-12 col-xs-12 form-group pull-right">
                    <button class="btn btn-info pull-right" id="btnXuatExcelCongNgay" style="margin-right: 5px;">
                        <i class="fa fa-download"></i>
                        Xuất Excel
                    </button>
                </div>
                <div class="col-md-3 col-sm-12 col-xs-12 form-group pull-right">
                    <select id="ddlDieuKienKhac" class="form-control"></select>
                </div>
                <div class="col-md-3 col-sm-12 col-xs-12 form-group pull-right">
                    <label class="control-label pull-right">Điều kiện khác</label>
                </div>

            </div>
            <div class="clearfix"></div>
            <div class="table-responsive" id="table-responsiveDMHeSoLuong">

                <table id="dg" class="easyui-datagrid" title="Bảng chấm công nhân viên" style="width:1000px;height:250px" cellspacing="0">
             
                    <thead data-options="frozen: true">
                
                        <tr>
                            <th data-options="field:'TenNhanVien',width:150 ">Tên nhân viên</th>
                            <th data-options="field:'TenKhuVuc',width:100 ">Khu vực</th>
                        </tr>
                    </thead>
                    <thead>
                        <tr>
                            <th data-options="field:'TenPhong',width:120 ">Phòng</th>

                            <th data-options="field:'Ngay01',width:60, formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">01</th>
                            <th data-options="field:'Ngay02',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">02</th>
                            <th data-options="field:'Ngay03',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">03</th>

                            <th data-options="field:'Ngay04',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">04</th>
                            <th data-options="field:'Ngay05',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">05</th>
                            <th data-options="field:'Ngay06',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">06</th>
                            <th data-options="field:'Ngay07',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">07</th>
                            <th data-options="field:'Ngay08',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">08</th>
                            <th data-options="field:'Ngay09',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">09</th>
                            <th data-options="field:'Ngay10',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">10</th>
                            <th data-options="field:'Ngay11',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">11</th>
                            <th data-options="field:'Ngay12',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">12</th>
                            <th data-options="field:'Ngay13',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">13</th>
                            <th data-options="field:'Ngay14',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">14</th>
                            <th data-options="field:'Ngay15',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">15</th>
                            <th data-options="field:'Ngay16',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">16</th>
                            <th data-options="field:'Ngay17',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">17</th>
                            <th data-options="field:'Ngay18',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">18</th>
                            <th data-options="field:'Ngay19',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">19</th>
                            <th data-options="field:'Ngay20',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">20</th>
                            <th data-options="field:'Ngay21',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">21</th>
                            <th data-options="field:'Ngay22',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">22</th>
                            <th data-options="field:'Ngay23',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">23</th>
                            <th data-options="field:'Ngay24',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">24</th>
                            <th data-options="field:'Ngay25',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">25</th>
                            <th data-options="field:'Ngay26',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">26</th>
                            <th data-options="field:'Ngay27',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">27</th>
                            <th data-options="field:'Ngay28',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">28</th>
                            <th data-options="field:'Ngay29',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">29</th>
                            <th data-options="field:'Ngay30',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">30</th>
                            <th data-options="field:'Ngay31',width:60,  formatter: formatNgayCN,
                                editor:{
                                    type:'combobox',
                                    options:{
                                        valueField:'Id',
                                        textField:'TenKyHieu',
                                        method:'get',
                                        url:'/templates/products.json',
                                        required:true
                                    }
                                }">31</th>

                            @*<th data-options="field:'Ngay01',width:10, formatter:formatPrice ">01</th>
                                   <th data-options="field:'HeSo',width:80,align:'right' , editor:{type:'numberbox',options:{min:0,precision:2,groupSeparator:','}} ">Hệ số</th>
                <th data-options="field:'MucLuong', width:80, align:'right', editor:{type:'numberbox',options:{min:0,groupSeparator:','}} ">Mức lương </th>
                <th data-options="field:'Stt',width:60,align:'center', editor:{type:'numberbox', options:{min:0}} ">Stt</th>
                <th data-options="field:'Status',width:60,align:'center', hidden:'true' ">Trạng thái</th>*@
                            <th data-options="field:'Id',width:60,align:'center', hidden:'true', editor: 'numberbox' ">Id</th>
                        </tr>
                    </thead>

                </table>

                <div id="tb" style="height:auto">
                    <a class="easyui-linkbutton btndelete" data-options="iconCls:'icon-cut',plain:true">Xóa</a>
                    <a class="easyui-linkbutton btnaccept" data-options="iconCls:'icon-save',plain:true">Lưu</a>

                </div>
                <script type="text/javascript">
                    function formatNgayCN(val, row) {
                        if (val === 'CN') {
                            return '<span style="color:red;">' + val + '</span>';
                        }
                        else if (val === 'KO') {
                            return '<input type="hidden" value="" />';
                        }
                        else {
                            return val;
                        }
                    }
                </script>



            </div>

        </div>
    </div>


</div>

